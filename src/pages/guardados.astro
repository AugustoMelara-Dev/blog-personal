---
import BaseLayout from "../layouts/BaseLayout.astro";
import SavedPosts from "../components/SavedPosts.tsx";
import AnimatedPost from "../components/AnimatedPost.tsx";
import { getCollection } from "astro:content";
import readingTime from "reading-time";

const allPosts = (await getCollection("posts"))
  .filter((post) => !post.data.draft)
  .sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf());

const postsData = allPosts.map((post) => ({
  slug: post.slug,
  title: post.data.title,
  description: post.data.description,
  tags: post.data.tags || [],
  pubDate: post.data.pubDate.toISOString(),
  readingTime: readingTime(post.body || "").text.replace("read", "lectura"),
}));
---

<BaseLayout title="Guardados" description="Tus posts guardados">
  <div class="max-w-5xl mx-auto px-6 py-16 md:py-24">
    <AnimatedPost client:load index={0}>
      <div class="mb-12">
        <div class="w-10 h-[3px] bg-lime-400 mb-6"></div>
        <h1 class="text-5xl font-black text-[#f5f5f5] mb-3">Guardados</h1>
        <p class="text-[#525252]">Los posts que marcaste para leer despu√©s.</p>
      </div>
    </AnimatedPost>

    <SavedPosts client:load posts={postsData} />
  </div>
</BaseLayout>
