---
import TagBadge from "./TagBadge.astro";
import { format } from "date-fns";
import { es } from "date-fns/locale";
import Icon from "./icons/Icon.tsx";

interface Props {
  title: string;
  description: string;
  pubDate: Date;
  tags: string[];
  readingTime: string;
  slug: string;
  featured?: boolean;
  quote?: string;
  versiculo?: string;
  index?: number;
}

const {
  title,
  description,
  pubDate,
  tags,
  readingTime,
  slug,
  featured,
  quote,
  versiculo,
  index = 0,
} = Astro.props;

const formattedDate = format(pubDate, "d 'de' MMMM, yyyy", { locale: es });
const orderNum = String(index + 1).padStart(2, "0");
---

{
  featured ? (
    <a
      href={`/blog/${slug}`}
      class="group block bg-[#111111] border border-[#1f1f1f] rounded-xl border-l-[3px] border-l-lime-400 p-8 md:p-10 transition-all duration-300 hover:scale-[1.005] hover:border-lime-400/50 min-h-[280px]"
    >
      <div class="flex flex-col md:flex-row gap-8">
        <div class="flex-[3] flex flex-col gap-4">
          <span class="inline-block self-start px-3 py-1 rounded bg-lime-400/10 text-lime-400 text-xs font-semibold uppercase tracking-widest">
            Destacado
          </span>

          <h3 class="text-2xl font-bold text-[#f5f5f5] leading-tight group-hover:text-lime-400 transition-colors duration-200">
            {title}
          </h3>

          {quote && (
            <div class="border-l-2 border-lime-400 pl-4">
              <p class="text-base italic text-[#a3a3a3] leading-relaxed">
                "{quote}"
              </p>
            </div>
          )}

          <p class="text-base text-[#737373] line-clamp-3 leading-relaxed">
            {description}
          </p>
        </div>

        <div class="flex-[2] flex flex-col gap-4 md:items-end md:text-right justify-between">
          <div>
            <time
              datetime={pubDate.toISOString()}
              class="block text-2xl font-bold text-[#2a2a2a]"
            >
              {format(pubDate, "dd")}
            </time>
            <span class="text-xs text-[#525252] uppercase tracking-wider">
              {format(pubDate, "MMMM yyyy", { locale: es })}
            </span>
          </div>

          <span class="text-xs text-[#525252]">{readingTime}</span>

          {tags.length > 0 && (
            <div class="flex flex-wrap gap-2 md:justify-end">
              {tags.map((tag) => (
                <TagBadge tag={tag} linked={false} />
              ))}
            </div>
          )}
        </div>
      </div>
    </a>
  ) : (
    <a
      href={`/blog/${slug}`}
      class="group block relative bg-[#0f0f0f] border border-[#1a1a1a] rounded-[10px] p-7 transition-all duration-200 hover:bg-[#141414] hover:border-[#2a2a2a] overflow-hidden"
    >
      <span class="absolute top-4 right-6 text-5xl font-black text-[#1a1a1a] leading-none select-none pointer-events-none">
        {orderNum}
      </span>

      <h3 class="text-xl font-semibold text-[#f5f5f5] line-clamp-2 group-hover:text-lime-400 transition-colors duration-200 pr-12">
        {title}
      </h3>

      <p class="text-sm text-[#737373] line-clamp-2 mt-2 leading-relaxed">
        {description}
      </p>

      <div class="flex flex-wrap items-center gap-3 mt-4 text-xs text-[#525252]">
        <time datetime={pubDate.toISOString()} class="flex items-center gap-1">
          <Icon name="Calendar" size={12} color="#525252" client:load />{" "}
          {formattedDate}
        </time>
        <span class="text-[#1a1a1a]">·</span>
        <span class="flex items-center gap-1">
          <Icon name="Clock" size={12} color="#525252" client:load />{" "}
          {readingTime}
        </span>
        {tags.length > 0 && (
          <>
            <span class="text-[#1a1a1a]">·</span>
            {tags.map((tag) => (
              <span class="text-[#525252] flex items-center gap-1">
                <Icon name="Tag" size={12} color="#525252" client:load /> {tag}
              </span>
            ))}
          </>
        )}
      </div>
    </a>
  )
}
